<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sheet Music Roll - Local VexFlow</title>
    <link rel="stylesheet" href="styles.css" />

    <!-- 
        SETUP INSTRUCTIONS:
        1. Download VexFlow from: https://github.com/0xfe/vexflow/releases
        2. Extract and place 'vexflow.js' in the same folder as this HTML file
        3. Update the script src below to point to your local vexflow.js file
        4. Open this HTML file in your browser
        
        OR use this CDN (if accessible):
        <script src="https://cdn.jsdelivr.net/npm/vexflow@4.2.3/build/vexflow-debug.js"></script>
    -->
    <!-- VexFlow from CDN -->
    <script src="https://cdn.jsdelivr.net/npm/vexflow@4.2.5/build/cjs/vexflow.js"></script>

    <!-- Robust MusicXML Parser using xml-js library -->
    <script src="https://cdn.jsdelivr.net/npm/xml-js@1.6.11/dist/xml-js.min.js"></script>

    <!-- FastXML Parser -->
    <!-- <script src="https://cdn.jsdelivr.net/npm/fast-xml-parser/dist/fxparser.bundle.js"></script> -->
    <!-- <script src="https://cdnjs.cloudflare.com/ajax/libs/fast-xml-parser/5.2.5/fxparser.min.js""></script> -->

    <script>
        // Verify libraries loaded
        if (typeof Vex === 'undefined') {
            console.error('❌ VexFlow failed to load');
        } else {
            console.log('✅ VexFlow loaded');
        }

        if (typeof xml2js === 'undefined') {
            console.error('❌ xml-js failed to load');
        } else {
            console.log('✅ XML parser loaded');
        }

    </script>
</head>

<body>
    <div class="header">
        <div class="title">♫ Sheet Music Roll</div>
        <div class="score-display">
            <div class="score-item">
                <div class="score-label">Notes</div>
                <div class="score-value" id="noteCount">0</div>
            </div>
            <div class="score-item">
                <div class="score-label">Tempo</div>
                <div class="score-value" id="currentTempo">100</div>
            </div>
        </div>
    </div>

    <div class="main-container">
        <div class="sheet-music-viewport">
            <div class="guide-line"></div>
            <div class="music-scroll-wrapper" id="scrollWrapper">
                <div id="musicCanvas">
                    <div class="loading">Loading VexFlow...</div>
                </div>
            </div>
        </div>

        <div class="controls-container">
            <div class="file-upload-section">
                <h3>Upload MusicXML File</h3>
                <input type="file" id="fileInput" class="file-input" accept=".xml,.musicxml,.mxl">
                <label for="fileInput" class="file-label">Choose File</label>
                <div class="file-name" id="fileName">Using default song</div>
                <div id="statusMessage"></div>
            </div>

            <div class="controls">

                <div class="scroll-mode-control">
                    <span>Scroll Mode</span>
                    <div class="mode-buttons">
                        <button class="mode-btn active" data-mode="smooth">Smooth</button>
                        <button class="mode-btn" data-mode="jumping">Jumping</button>
                        <button class="mode-btn" data-mode="center">Center Focus</button>
                    </div>
                </div>
                <div class="tempo-control">
                    <span>Tempo (BPM)</span>
                    <input type="range" class="tempo-slider" id="tempoSlider" min="40" max="180" value="100" step="5">
                    <span class="tempo-value" id="tempoValue">100 BPM</span>
                </div>
                <div class="button-group">
                    <button class="btn btn-primary" id="startBtn">Start</button>
                    <button class="btn btn-secondary" id="pauseBtn">Pause</button>
                    <button class="btn btn-secondary" id="resetBtn">Reset</button>
                </div>
            </div>
        </div>
    </div>

    <script src="app.js"></script>


</body>

</html>